# 🖐️ AI 手勢滑鼠控制系統 (Hand Gesture Mouse Controller)

> 使用 **MediaPipe + OpenCV + PyAutoGUI + PyQt5** 實現以手勢控制滑鼠游標、點擊與滾動的智慧互動系統。

---

## 📘 專案簡介

本專案透過 **攝影機影像偵測手部關節點**，將使用者手勢轉換成滑鼠操作。  
能實現以下功能：

- 移動滑鼠游標（以食指位置為基準）  
- 拇指 + 食指靠近 → 左鍵點擊  
- 拇指 + 食指 + 中指靠近 → 右鍵點擊  
- 食指與中指併攏上下移動 → 模擬滾輪滾動  
- 手指距離越近，滑鼠移動越「平滑」  
- 可動態調整靈敏度、距離閾值與平滑化參數  
- 支援 **Ctrl + Q** 一鍵啟用/停用手勢控制  
- 介面最小化至系統托盤，不干擾使用者操作  

---

## 🧩 系統架構與邏輯說明

```
main.py
│
├── HandMouseController (執行緒)
│   ├── Mediapipe 偵測手部關節點
│   ├── 計算拇指與食指距離 → 決定平滑度
│   ├── 控制滑鼠移動、點擊、滾動
│   ├── 支援 Ctrl+Q 快捷鍵開關功能
│   └── 實時影像顯示 (OpenCV)
│
├── MainWindow (PyQt5 主介面)
│   ├── 滑桿設定距離閾值與靈敏度
│   ├── 即時更新控制器參數
│   ├── 防止誤關閉 → 自動縮到系統托盤
│
├── SystemTrayApp
│   ├── 常駐系統托盤
│   ├── 顯示/隱藏設定視窗
│   └── 提供退出選項
│
└── 熱鍵控制
    └── Ctrl + Q → 切換「手勢控制啟用」狀態
```

---

## ⚙️ 主要功能

| 功能 | 操作手勢 | 說明 |
|------|-----------|------|
| 移動滑鼠 | 食指位置 | 食指移動即控制游標 |
| 左鍵點擊 | 拇指 + 食指靠近 | 觸發 `mouseDown` / `mouseUp` |
| 右鍵點擊 | 拇指 + 食指 + 中指靠近 | 觸發右鍵 |
| 滾輪滾動 | 食指與中指併攏並上下移動 | 模擬滾輪滾動 |
| 模式切換 | Ctrl + Q | 快速啟用 / 停用手勢控制 |
| 平滑移動 | 拇指與食指距離越近 → 滑鼠移動更柔順 | 自動平滑化控制 |

---

## 🧮 平滑化邏輯

| 參數 | 說明 |
|------|------|
| `start_smooth_distance` | 開始平滑化的手指距離（預設 200 像素） |
| `min_distance` | 距離低於此值時，平滑化最強（0.05 秒移動） |
| `max_distance` | 距離高於此值時，平滑化最弱（0.01 秒移動） |
| `smoothing` | 根據距離線性插值計算滑鼠移動速度 |

---

## 🖥️ 介面預覽與操作邏輯

- **左鍵距離閾值**：調整拇指與食指觸發點擊的距離  
- **右鍵距離閾值**：三指靠近觸發右鍵  
- **滾動靈敏度**：數值越小越敏感  
- **最大平滑度**：控制游標移動的延遲感  
- **最小手指距離**：平滑化距離調整門檻  
- **開始平滑化距離**：控制平滑區域範圍  

系統托盤選單：
- 「顯示 / 隱藏設定視窗」  
- 「退出」  

---

## ⚙️ 環境需求與安裝

| 套件 | 功能 | 安裝指令 |
|------|------|-----------|
| `opencv-python` | 攝影機影像讀取與顯示 | `pip install opencv-python` |
| `mediapipe` | 手部關節辨識 | `pip install mediapipe` |
| `pyautogui` | 控制滑鼠游標與按鍵 | `pip install pyautogui` |
| `keyboard` | 偵測 Ctrl+Q 熱鍵 | `pip install keyboard` |
| `PyQt5` | 圖形化介面與系統托盤 | `pip install PyQt5` |

---

## 🚀 使用方式

1. **安裝依賴**
   ```bash
   pip install opencv-python mediapipe pyautogui keyboard PyQt5
   ```

2. **執行主程式**
   ```bash
   python main.py
   ```

3. **操作說明**
   - 手勢控制自動啟用。  
   - 按下 **Ctrl + Q** 可暫時停用再啟用。  
   - 點右上角「X」不會關閉，而是最小化到托盤。  
   - 右鍵托盤圖示可選擇「退出」。  

---

## ⚠️ 注意事項

- 若滑鼠失控，可按 **Ctrl + Alt + Del** 強制中止程式。  
- Mediapipe 偵測需光線充足。  
- 若使用高刷新率螢幕或多螢幕，滑鼠移動可微調平滑參數。  
- 預設 `icon.png` 為系統托盤圖示，若未提供將顯示預設圖示。  

---

## 🧱 專案結構

```
📂 HandGestureMouse
├── main.py               # 主程式 (含控制與介面)
├── icon.png              # 系統托盤圖示 (可自行更換)
├── README.md             # 專案說明文件
```

---

## 🧠 技術要點

- **MediaPipe Hands**：21 個手部關節即時追蹤  
- **PyAutoGUI**：模擬滑鼠行為 (moveTo / click / scroll)  
- **PyQt5 SystemTray**：常駐背景執行、快速操作  
- **多執行緒設計**：Mediapipe 偵測與 GUI 分離執行，確保流暢  

---

## 👨‍💻 作者

**Aries Wu**  
AI × Robotics × UX Engineering  
📧 arieswu001@gmail.com  


